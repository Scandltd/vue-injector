/*!
 * 
 *   @scandltd/vue-injector v4.0.0
 *   (c) 2021 Scandltd
 *   @license GPL-2.0
 *
 */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,(function(){return(()=>{"use strict";var e,t,n={d:(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};function o(t,n){void 0===n&&(n={});var r=t,o=Reflect.ownKeys(n).filter((function(e){return null===t.match(new RegExp("\\{"+String(e)+"\\}"))}));return o.length&&console.warn(e.ERROR_BUILD_MESSAGE+o),Object.keys(n).forEach((function(e){var t=new RegExp("\\{"+e+"\\}");r=r.replace(t,n[e])})),r}function i(t,n){if(!t)throw new Error(e.ERROR_TYPE+" "+n)}n.r(r),n.d(r,{Inject:()=>p,Injectable:()=>u,VueInjector:()=>_,default:()=>O}),function(e){e.ERROR_TYPE="[@scandltd/vue-injector]:",e.ERROR_INJECTABLE_OPTIONS_CONFLICT="@injectable can take only one parameter either {names}",e.ERROR_BUILD_MESSAGE='function "message". Parameters in a string do not match those in array: ',e.ERROR_INIT_PLUGIN="not installed. Make sure to call `Vue.use(VueInjector)` before creating root instance.",e.ERROR_PROVIDERS_TYPE="providers are not objects",e.ERROR_USE_DECORATOR="no decorator Injectable",e.ERROR_USE_FACTORY_RETURN="useFactory invalid return",e.ERROR_USE_VALUE_RETURN="invalid useValue",e.ERROR_USE_FACTORY_TYPE="{name} invalid type useFactory: must be 'function'",e.ERROR_EMTY_INJECT_PARAMS="@inject must get a service as parameter"}(e||(e={})),function(e){e.WARNING_000="Wrong service registration. Service name: {name}.\n@injectable can take only one parameter either useFactory or useValue, but got {options}"}(t||(t={}));var c,a={TYPE:Symbol("inject:type"),VALUE:Symbol("inject:value"),NAME:Symbol("inject:name"),SERVICE:Symbol("inject:service"),TS_TYPE:"design:type"};!function(e){e.useFactory="useFactory",e.useValue="useValue"}(c||(c={}));var s=function(){function n(){}return Object.defineProperty(n,"whitelist",{get:function(){return Reflect.ownKeys(c)},enumerable:!1,configurable:!0}),n.getOptionKeys=function(e){return Reflect.ownKeys(e)},n.isOtherProperty=function(e){return!n.getOptionKeys(e).every((function(e){return-1!==n.whitelist.indexOf(String(e))}))},n.isCollisionProps=function(e){return n.whitelist.filter((function(t){return Reflect.has(e,t)})).length>1},n.getType=function(e){return n.whitelist.find((function(t){return Reflect.has(e,t)}))},n.getServiceType=function(e,t){if(n.isOtherProperty(t)&&n.warnMassage(e,t),n.isCollisionProps(t))throw n.errorMassage();return n.getType(t)?c[n.getType(t)]:null},n.errorMassage=function(){throw i(!1,o(e.ERROR_INJECTABLE_OPTIONS_CONFLICT,{names:JSON.stringify(n.whitelist)}))},n.warnMassage=function(e,n){o(t.WARNING_000,{name:e.name,options:JSON.stringify(n)})},n.make=function(e,t){return void 0===t&&(t={}),this.defineMetadata(e,t),this.createDecorators(e),e},n.defineMetadata=function(e,t){var r=n.getServiceType(e,t);r&&(Reflect.defineMetadata(a.TYPE,r,e),Reflect.defineMetadata(a.VALUE,t[r],e)),Reflect.defineMetadata(a.NAME,e.name,e),Reflect.defineMetadata(a.SERVICE,!0,e)},n.createDecorators=function(e){e.__decorators__&&(e.__decorators__.forEach((function(t){return t(e.prototype)})),delete e.__decorators__)},n}();function u(e){return"function"==typeof e?s.make(e):function(t){return s.make(t,e)}}function f(e){return t=function(t,n){(t.providers||(t.providers={}))[n]=e},function(e,n){var r="function"==typeof e?e:e.constructor,o={enumerable:!0,configurable:!0,initializer:function(){return this.__proto__[n]}};return Reflect.defineProperty(e,n,o),(r.__decorators__||(r.__decorators__=[])).push((function(e){return t(e,n)})),o};var t}function p(t,n){if("function"==typeof t||void 0===n)return f(t);var r=Reflect.getMetadata(a.TS_TYPE,t,n);if(void 0===r)throw i(!1,e.ERROR_EMTY_INJECT_PARAMS);f(r)(t,n)}var l=function(){function e(){}return e.bind=function(e,t,n){return Reflect.defineProperty(e,n,{enumerable:!0,configurable:!1,get:function(){return t}})},e}(),R=function(){function t(){}return t.prototype.getFactory=function(t){var n=Reflect.getMetadata(a.NAME,t),r=Reflect.getMetadata(a.VALUE,t);if(r&&"function"!=typeof r)throw i(!1,o(e.ERROR_USE_FACTORY_TYPE,{name:n}));var c=r();if(!c)throw i(!1,e.ERROR_USE_FACTORY_RETURN);return function(){return c}},t}(),y=function(){function t(){}return t.prototype.getFactory=function(t){var n=Reflect.getMetadata(a.VALUE,t);if(n)return function(){return n};throw i(!1,e.ERROR_USE_VALUE_RETURN)},t}(),d=function(){function e(){}return e.prototype.getFactory=function(e){var t=new e;return function(){return t}},e}(),h=function(){function e(){}return e.make=function(t){var n=Reflect.getMetadata(a.TYPE,t);return e.getFactoryByName(n).getFactory(t)},e.getFactoryByName=function(e){switch(e){case c.useFactory:return new R;case c.useValue:return new y;default:return new d}},e}(),v=function(){function t(e){this.service=e,this.factory=null,this.register()}return Object.defineProperty(t.prototype,"instance",{get:function(){return this.factory()},enumerable:!1,configurable:!0}),t.prototype.bindTo=function(e,t){return l.bind(e,this.instance,t||this.name)},Object.defineProperty(t.prototype,"name",{get:function(){return Reflect.getMetadata(a.NAME,this.service)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isService",{get:function(){return!!Reflect.getMetadata(a.SERVICE,this.service)},enumerable:!1,configurable:!0}),t.prototype.isApp=function(e){return e===t.app},t.prototype.register=function(){if(this.isApp(this.service)?this.factory=function(){return t.app}:!this.factory&&this.isService&&(this.factory=h.make(this.service)),this.factory)return this.factory;throw i(!1,e.ERROR_USE_DECORATOR)},t}(),E=function(){function t(e,t){this.rootServices=[],v.app=e,this.app=e,this.rootServices=t,this.services=new Map}return t.prototype.registerComponent=function(e){var t=this;this.provideAllServices(e),this.rootServices.length&&this.rootServices.forEach((function(n){t.provide(n,e)}))},t.prototype.get=function(e){return this.provide(e)},t.prototype.provide=function(e,t,n){var r;void 0===t&&(t=null),this.services.has(e)||((null===(r=null==e?void 0:e.prototype)||void 0===r?void 0:r.providers)&&this.registerDependencies(e.prototype),this.services.set(e,new v(e)));var o=this.services.get(e);return t&&o.bindTo(t,n),o.instance},t.prototype.provideAllServices=function(t){var n,r=this;if(Object.hasOwnProperty.call(t,"providers")){var o=t.providers;if(!o||(n=o,Array.isArray(n)||"object"!=typeof n||null===n))throw i(!1,e.ERROR_PROVIDERS_TYPE);Object.keys(o).forEach((function(e){o&&Object.hasOwnProperty.call(o,e)&&r.provide(o[e],t,e)}))}},t.prototype.registerDependencies=function(e){this.provideAllServices(e),delete e.providers},t}(),_=function(){function e(e){var t=e.app,n=e.root,r=e.store;this.rootServices=[],this.rootServices=n||[],r&&(r.$injector=this),this.init(t)}return Object.defineProperty(e,"app",{get:function(){return this},enumerable:!1,configurable:!0}),e.prototype.init=function(e){this.app||(this.app=e,this.injector=new E(this.app,this.rootServices))},e.prototype.initComponent=function(e){return this.injector&&this.injector.registerComponent(e)},e.prototype.get=function(e){return this.injector&&this.injector.get(e)},e}();_.version="__VERSION__";var g=function(){return(g=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};const O={install:function(e,t){e.config.globalProperties.$injector=new _(g(g({},t),{app:e})),e.mixin({beforeCreate:function(){var e;void 0!==this.$options.providers&&(this.providers=this.$options.providers),"function"==typeof(null===(e=null==this?void 0:this.$injector)||void 0===e?void 0:e.initComponent)&&this.$injector.initComponent(this)}})}};return r})()}));