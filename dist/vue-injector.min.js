/*!
  * @scandltd/vue-injector v3.1.0
  * (c) 2019 Scandltd
  * @license GPL-2.0
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).VueInjector={})}(this,function(e){"use strict";var n,o,t,r;function i(r,n){void 0===n&&(n={});var i=r,e=Reflect.ownKeys(n).filter(function(e){return null===r.match(new RegExp("{"+String(e)+"}"))});return e.length&&console.warn(o.ERROR_002+e),Object.keys(n).forEach(function(e){var t=new RegExp("{"+e+"}");i=r.replace(t,n[e])}),i}function u(e,t){if(!e)throw new Error(o.ERROR_000+" "+t)}(t=o=o||{}).ERROR_000="[@scandltd/vue-injector]:",t.ERROR_001="@injectable can take only one parameter either {names}",t.ERROR_002='function "message". Parameters in a string do not match those in array: ',t.ERROR_003="not installed. Make sure to call `Vue.use(VueInjector)` before creating root instance.",t.ERROR_004="providers are not objects",t.ERROR_005="no decorator Injectable",t.ERROR_006="useFactory invalid return",t.ERROR_007="invalid useValue",t.ERROR_008="{name} invalid type useFactory: must be 'function'",t.ERROR_009="{method} is not a function",t.ERROR_010="@inject must get a service as parameter",(r||(r={})).WARNING_000="Wrong service registration. Service name: {name}.\n@injectable can take only one parameter either useFactory or useValue, but got {options}";var a="undefined"!=typeof window;function f(e){return!Array.isArray(e)&&"object"==typeof e&&null!==e}var s,c,p,h,l=(y.bind=function(e,t,r){return Reflect.defineProperty(e,r,{enumerable:!0,configurable:!1,get:function(){return t}})},y);function y(){}(c=s=s||{}).TYPE="inject:type",c.VALUE="inject:value",c.NAME="inject:name",c.SERVICE="inject:service",c.TS_TYPE="design:type",(h=p=p||{}).useFactory="useFactory",h.useValue="useValue";var d=(v.prototype.getFactory=function(e){var t=Reflect.getMetadata(s.NAME,e),r=Reflect.getMetadata(s.VALUE,e);if(r&&"function"!=typeof r)throw u(!1,i(o.ERROR_008,{name:t}));return function(){var e=r();if(!e)throw u(!1,o.ERROR_006);return e}},v);function v(){}var _=(g.prototype.getFactory=function(e){var t=Reflect.getMetadata(s.VALUE,e);if(t)return function(){return t};throw u(!1,o.ERROR_007)},g);function g(){}var w=(b.prototype.getFactory=function(e){var t=new e;return function(){return t}},b);function b(){}var R=(m.make=function(e){var t=Reflect.getMetadata(s.TYPE,e);return m.getFactoryByName(t).getFactory(e)},m.getFactoryByName=function(e){switch(e){case p.useFactory:return new d;case p.useValue:return new _;default:return new w}},m);function m(){}var j=(E.prototype.instance=function(){return this.$factory()},E.prototype.bindTo=function(e,t){return e?l.bind(e,this.$factory(),t||this.name):this.factory},Object.defineProperty(E.prototype,"factory",{get:function(){return this.$factory},set:function(e){this.$factory=e},enumerable:!0,configurable:!0}),Object.defineProperty(E.prototype,"name",{get:function(){return Reflect.getMetadata(s.NAME,this.service)},enumerable:!0,configurable:!0}),Object.defineProperty(E.prototype,"isService",{get:function(){return Reflect.getMetadata(s.SERVICE,this.service)},enumerable:!0,configurable:!0}),E.prototype.register=function(){if("Vue"===this.service.name&&(this.factory=function(){return E.app}),!this.factory&&this.isService&&(this.factory=R.make(this.service)),this.factory)return this.factory;throw u(!1,o.ERROR_005)},E);function E(e){this.service=e,this.$factory=null,this.register()}var O=(k.prototype.registerComponent=function(t){var r=this;if(Object.hasOwnProperty.call(t,"_providers")){var n=t._providers;if(!n||!f(n))throw u(!1,o.ERROR_004);Object.keys(n).forEach(function(e){n&&Object.hasOwnProperty.call(n,e)&&r.provide(t._providers[e],t,e)})}this.rootServices.length&&this.rootServices.forEach(function(e){r.provide(e,t)})},k.prototype.get=function(e){return this.provide(e)},k.prototype.provide=function(e,t,r){if(void 0===t&&(t=null),!this.services.has(e)){e.prototype.providers&&this.registerDependencies(e.prototype);var n=new j(e);this.services.set(e,n)}var i=this.services.get(e);return i.bindTo(t,r),i.instance()},k.prototype.registerDependencies=function(t){var r=this;if(!f(t.providers))throw u(!1,o.ERROR_004);Object.keys(t.providers).forEach(function(e){r.provide(t.providers[e],t,e)}),delete t.providers},k);function k(e,t){this.rootServices=[],j.app=e,this.app=e,this.rootServices=t,this.services=new Map}var M,P,T="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};P=M=M||{},function(){var e="object"==typeof T?T:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),t=r(P);function r(r,n){return function(e,t){"function"!=typeof r[e]&&Object.defineProperty(r,e,{configurable:!0,writable:!0,value:t}),n&&n(e,t)}}void 0===e.Reflect?e.Reflect=P:t=r(e.Reflect,t),function(e){var s=Object.prototype.hasOwnProperty,t=typeof Symbol==="function",o=t&&typeof Symbol.toPrimitive!=="undefined"?Symbol.toPrimitive:"@@toPrimitive",a=t&&typeof Symbol.iterator!=="undefined"?Symbol.iterator:"@@iterator",r=typeof Object.create==="function",n={__proto__:[]}instanceof Array,i=!r&&!n,c={create:r?function(){return ie(Object.create(null))}:n?function(){return ie({__proto__:null})}:function(){return ie({})},has:i?function(e,t){return s.call(e,t)}:function(e,t){return t in e},get:i?function(e,t){return s.call(e,t)?e[t]:undefined}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),f=typeof process==="object"&&process.env&&process.env["REFLECT_METADATA_USE_MAP_POLYFILL"]==="true",p=!f&&typeof Map==="function"&&typeof Map.prototype.entries==="function"?Map:te(),l=!f&&typeof Set==="function"&&typeof Set.prototype.entries==="function"?Set:re(),h,y=new(!f&&typeof WeakMap==="function"?WeakMap:ne());function d(e,t,r,n){if(!C(r)){if(!D(e)){throw new TypeError}if(!N(t)){throw new TypeError}if(!N(n)&&!C(n)&&!K(n)){throw new TypeError}if(K(n)){n=undefined}r=Y(r);return k(e,t,r,n)}else{if(!D(e)){throw new TypeError}if(!G(t)){throw new TypeError}return O(e,t)}}function v(r,n){function e(e,t){if(!N(e)){throw new TypeError}if(!C(t)&&!J(t)){throw new TypeError}x(r,n,e,t)}return e}function _(e,t,r,n){if(!N(r)){throw new TypeError}if(!C(n)){n=Y(n)}return x(e,t,r,n)}function g(e,t,r){if(!N(t)){throw new TypeError}if(!C(r)){r=Y(r)}return P(e,t,r)}function w(e,t,r){if(!N(t)){throw new TypeError}if(!C(r)){r=Y(r)}return T(e,t,r)}function b(e,t,r){if(!N(t)){throw new TypeError}if(!C(r)){r=Y(r)}return S(e,t,r)}function R(e,t,r){if(!N(t)){throw new TypeError}if(!C(r)){r=Y(r)}return A(e,t,r)}function m(e,t){if(!N(e)){throw new TypeError}if(!C(t)){t=Y(t)}return V(e,t)}function j(e,t){if(!N(e)){throw new TypeError}if(!C(t)){t=Y(t)}return I(e,t)}function E(e,t,r){if(!N(t)){throw new TypeError}if(!C(r)){r=Y(r)}var n=M(t,r,false);if(C(n)){return false}if(!n.delete(e)){return false}if(n.size>0){return true}var i=y.get(t);i.delete(r);if(i.size>0){return true}y.delete(t);return true}function O(e,t){for(var r=e.length-1;r>=0;--r){var n=e[r];var i=n(t);if(!C(i)&&!K(i)){if(!G(i)){throw new TypeError}t=i}}return t}function k(e,t,r,n){for(var i=e.length-1;i>=0;--i){var o=e[i];var u=o(t,r,n);if(!C(u)&&!K(u)){if(!N(u)){throw new TypeError}n=u}}return n}function M(e,t,r){var n=y.get(e);if(C(n)){if(!r){return undefined}n=new p;y.set(e,n)}var i=n.get(t);if(C(i)){if(!r){return undefined}i=new p;n.set(t,i)}return i}function P(e,t,r){var n=T(e,t,r);if(n){return true}var i=ee(t);if(!K(i)){return P(e,i,r)}return false}function T(e,t,r){var n=M(t,r,false);if(C(n)){return false}return z(n.has(e))}function S(e,t,r){var n=T(e,t,r);if(n){return A(e,t,r)}var i=ee(t);if(!K(i)){return S(e,i,r)}return undefined}function A(e,t,r){var n=M(t,r,false);if(C(n)){return undefined}return n.get(e)}function x(e,t,r,n){var i=M(r,n,true);i.set(e,t)}function V(e,t){var r=I(e,t);var n=ee(e);if(n===null){return r}var i=V(n,t);if(i.length<=0){return r}if(r.length<=0){return i}var o=new l;var u=[];for(var a=0,f=r;a<f.length;a++){var s=f[a];var c=o.has(s);if(!c){o.add(s);u.push(s)}}for(var p=0,h=i;p<h.length;p++){var s=h[p];var c=o.has(s);if(!c){o.add(s);u.push(s)}}return u}function I(e,t){var r=[];var n=M(e,t,false);if(C(n)){return r}var i=n.keys();var o=H(i);var u=0;while(true){var a=X(o);if(!a){r.length=u;return r}var f=Q(a);try{r[u]=f}catch(e){try{Z(o)}finally{throw e}}u++}}function F(e){if(e===null){return 1}switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return e===null?1:6;default:return 6}}function C(e){return e===undefined}function K(e){return e===null}function $(e){return typeof e==="symbol"}function N(e){return typeof e==="object"?e!==null:typeof e==="function"}function L(e,t){switch(F(e)){case 0:return e;case 1:return e;case 2:return e;case 3:return e;case 4:return e;case 5:return e}var r=t===3?"string":t===5?"number":"default";var n=q(e,o);if(n!==undefined){var i=n.call(e,r);if(N(i)){throw new TypeError}return i}return U(e,r==="default"?"number":r)}function U(e,t){if(t==="string"){var r=e.toString;if(B(r)){var n=r.call(e);if(!N(n)){return n}}var i=e.valueOf;if(B(i)){var n=i.call(e);if(!N(n)){return n}}}else{var i=e.valueOf;if(B(i)){var n=i.call(e);if(!N(n)){return n}}var o=e.toString;if(B(o)){var n=o.call(e);if(!N(n)){return n}}}throw new TypeError}function z(e){return!!e}function W(e){return""+e}function Y(e){var t=L(e,3);if($(t)){return t}return W(t)}function D(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:Object.prototype.toString.call(e)==="[object Array]"}function B(e){return typeof e==="function"}function G(e){return typeof e==="function"}function J(e){switch(F(e)){case 3:return true;case 4:return true;default:return false}}function q(e,t){var r=e[t];if(r===undefined||r===null){return undefined}if(!B(r)){throw new TypeError}return r}function H(e){var t=q(e,a);if(!B(t)){throw new TypeError}var r=t.call(e);if(!N(r)){throw new TypeError}return r}function Q(e){return e.value}function X(e){var t=e.next();return t.done?false:t}function Z(e){var t=e["return"];if(t){t.call(e)}}function ee(e){var t=Object.getPrototypeOf(e);if(typeof e!=="function"||e===u){return t}if(t!==u){return t}var r=e.prototype;var n=r&&Object.getPrototypeOf(r);if(n==null||n===Object.prototype){return t}var i=n.constructor;if(typeof i!=="function"){return t}if(i===e){return t}return i}function te(){var i={};var r=[];var t=function(){function e(e,t,r){this._index=0;this._keys=e;this._values=t;this._selector=r}e.prototype["@@iterator"]=function(){return this};e.prototype[a]=function(){return this};e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var t=this._selector(this._keys[e],this._values[e]);if(e+1>=this._keys.length){this._index=-1;this._keys=r;this._values=r}else{this._index++}return{value:t,done:false}}return{value:undefined,done:true}};e.prototype.throw=function(e){if(this._index>=0){this._index=-1;this._keys=r;this._values=r}throw e};e.prototype.return=function(e){if(this._index>=0){this._index=-1;this._keys=r;this._values=r}return{value:e,done:true}};return e}();return function(){function e(){this._keys=[];this._values=[];this._cacheKey=i;this._cacheIndex=-2}Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:true,configurable:true});e.prototype.has=function(e){return this._find(e,false)>=0};e.prototype.get=function(e){var t=this._find(e,false);return t>=0?this._values[t]:undefined};e.prototype.set=function(e,t){var r=this._find(e,true);this._values[r]=t;return this};e.prototype.delete=function(e){var t=this._find(e,false);if(t>=0){var r=this._keys.length;for(var n=t+1;n<r;n++){this._keys[n-1]=this._keys[n];this._values[n-1]=this._values[n]}this._keys.length--;this._values.length--;if(e===this._cacheKey){this._cacheKey=i;this._cacheIndex=-2}return true}return false};e.prototype.clear=function(){this._keys.length=0;this._values.length=0;this._cacheKey=i;this._cacheIndex=-2};e.prototype.keys=function(){return new t(this._keys,this._values,n)};e.prototype.values=function(){return new t(this._keys,this._values,o)};e.prototype.entries=function(){return new t(this._keys,this._values,u)};e.prototype["@@iterator"]=function(){return this.entries()};e.prototype[a]=function(){return this.entries()};e.prototype._find=function(e,t){if(this._cacheKey!==e){this._cacheIndex=this._keys.indexOf(this._cacheKey=e)}if(this._cacheIndex<0&&t){this._cacheIndex=this._keys.length;this._keys.push(e);this._values.push(undefined)}return this._cacheIndex};return e}();function n(e,t){return e}function o(e,t){return t}function u(e,t){return[e,t]}}function re(){return function(){function e(){this._map=new p}Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:true,configurable:true});e.prototype.has=function(e){return this._map.has(e)};e.prototype.add=function(e){return this._map.set(e,e),this};e.prototype.delete=function(e){return this._map.delete(e)};e.prototype.clear=function(){this._map.clear()};e.prototype.keys=function(){return this._map.keys()};e.prototype.values=function(){return this._map.values()};e.prototype.entries=function(){return this._map.entries()};e.prototype["@@iterator"]=function(){return this.keys()};e.prototype[a]=function(){return this.keys()};return e}()}function ne(){var i=16;var t=c.create();var r=n();return function(){function e(){this._key=n()}e.prototype.has=function(e){var t=o(e,false);return t!==undefined?c.has(t,this._key):false};e.prototype.get=function(e){var t=o(e,false);return t!==undefined?c.get(t,this._key):undefined};e.prototype.set=function(e,t){var r=o(e,true);r[this._key]=t;return this};e.prototype.delete=function(e){var t=o(e,false);return t!==undefined?delete t[this._key]:false};e.prototype.clear=function(){this._key=n()};return e}();function n(){var e;do{e="@@WeakMap@@"+f()}while(c.has(t,e));t[e]=true;return e}function o(e,t){if(!s.call(e,r)){if(!t){return undefined}Object.defineProperty(e,r,{value:c.create()})}return e[r]}function u(e,t){for(var r=0;r<t;++r){e[r]=Math.random()*255|0}return e}function a(e){if(typeof Uint8Array==="function"){if(typeof crypto!=="undefined"){return crypto.getRandomValues(new Uint8Array(e))}if(typeof msCrypto!=="undefined"){return msCrypto.getRandomValues(new Uint8Array(e))}return u(new Uint8Array(e),e)}return u(new Array(e),e)}function f(){var e=a(i);e[6]=e[6]&79|64;e[8]=e[8]&191|128;var t="";for(var r=0;r<i;++r){var n=e[r];if(r===4||r===6||r===8){t+="-"}if(n<16){t+="0"}t+=n.toString(16).toLowerCase()}return t}}function ie(e){e.__=undefined;delete e.__;return e}e("decorate",d),e("metadata",v),e("defineMetadata",_),e("hasMetadata",g),e("hasOwnMetadata",w),e("getMetadata",b),e("getOwnMetadata",R),e("getMetadataKeys",m),e("getOwnMetadataKeys",j),e("deleteMetadata",E)}(t)}();var S=(Object.defineProperty(A,"whitelist",{get:function(){return Reflect.ownKeys(p)},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"decorators",{get:function(){return this.target.__decorators__},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"optionKeys",{get:function(){return Reflect.ownKeys(this.options)},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"isOtherProperty",{get:function(){return!this.optionKeys.every(function(e){return-1!==A.whitelist.indexOf(e)})},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"isCollisionProps",{get:function(){var t=this;return 1<A.whitelist.filter(function(e){return Reflect.has(t.options,e)}).length},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"type",{get:function(){var t=this;return A.whitelist.find(function(e){return Reflect.has(t.options,e)})},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"serviceType",{get:function(){if(this.isOtherProperty&&this.warnMassage(),this.isCollisionProps)throw A.errorMassage();return this.type?p[this.type]:null},enumerable:!0,configurable:!0}),A.errorMassage=function(){throw u(!1,i(o.ERROR_001,{names:JSON.stringify(A.whitelist)}))},A.prototype.make=function(e,t){return void 0===t&&(t={}),this.target=e,this.options=t,this.defineMetadata(),this.createDecorators(),this.target},A.prototype.warnMassage=function(){i(r.WARNING_000,{name:this.target.name,options:JSON.stringify(this.options)})},A.prototype.defineMetadata=function(){this.serviceType&&(Reflect.defineMetadata(s.TYPE,this.serviceType,this.target),Reflect.defineMetadata(s.VALUE,this.options[this.serviceType],this.target)),Reflect.defineMetadata(s.NAME,this.target.name,this.target),Reflect.defineMetadata(s.SERVICE,!0,this.target)},A.prototype.createDecorators=function(){var t=this;this.decorators&&(this.decorators.forEach(function(e){return e(t.target.prototype)}),delete this.target.__decorators__)},A);function A(){this.target=null,this.options={}}function x(r){return function(i){return function(e,t){var r="function"==typeof e?e:e.constructor,n={enumerable:!0,configurable:!0,initializer:function(){return this.__proto__[t]}};return Reflect.defineProperty(e,t,n),(r.__decorators__||(r.__decorators__=[])).push(function(e){return i(e,t)}),n}}(function(e,t){(e.providers||(e.providers={}))[t]=r})}var V=(Object.defineProperty(I,"app",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"install",{get:function(){return I.install},enumerable:!0,configurable:!0}),I.prototype.init=function(e){this.apps.push(e),this.app||(this.app=e,this.injector=new O(this.app,this.rootServices))},I.prototype.initComponent=function(e){return this.injector&&this.injector.registerComponent(e)},I.prototype.get=function(e){return this.injector&&this.injector.get(e)},I);function I(e){void 0===e&&(e={}),this.rootServices=[],this.app=null,this.injector=null,this.apps=[],this.rootServices=e.root||[],e.store&&(e.store.$injector=this)}V.install=function e(t){if(!e.installed||n!==t){e.installed=!0;var r=function(e){return void 0!==e};(n=t).mixin({beforeCreate:function(){r(this.$options.providers)&&(this._providers=this.$options.providers),r(this.$options.injector)?((this._injectorRoot=this)._injector=this.$options.injector,this._injector.init(this)):(this._injectorRoot=this.$parent&&this.$parent._injectorRoot||this,this._injectorRoot._injector&&this._injectorRoot._injector.initComponent(this))}}),Object.defineProperty(t.prototype,"$injector",{get:function(){return this._injectorRoot&&this._injectorRoot._injector}}),t.config.optionMergeStrategies._injectorRoot=function(e,t){return void 0===t?e:t}}},V.version="3.1.0",a&&window.Vue&&window.Vue.use(V),e.Inject=function(e,t){if("function"==typeof e)return x(e);var r=Reflect.getMetadata(s.TS_TYPE,e,t);if(void 0===r)throw u(!1,o.ERROR_010);x(r)(e,t)},e.Injectable=function(t){var r=new S;return"function"==typeof t?r.make(t):function(e){return r.make(e,t)}},e.VueInjector=V,Object.defineProperty(e,"__esModule",{value:!0})});