/*!
 * 
 *   @scandltd/vue-injector v4.0.3
 *   (c) 2021 Scandltd
 *   @license GPL-2.0
 * 
 */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var r,o;function i(e,t){void 0===t&&(t={});var n=e,o=Reflect.ownKeys(t).filter((function(t){return null===e.match(new RegExp("\\{"+String(t)+"\\}"))}));return o.length&&console.warn(r.ERROR_BUILD_MESSAGE+o),Object.keys(t).forEach((function(e){var r=new RegExp("\\{"+e+"\\}");n=n.replace(r,t[e])})),n}function c(e,t){if(!e)throw new Error(r.ERROR_TYPE+" "+t)}n.r(t),n.d(t,"VueInjector",(function(){return g})),n.d(t,"Injectable",(function(){return f})),n.d(t,"Inject",(function(){return l})),function(e){e.ERROR_TYPE="[@scandltd/vue-injector]:",e.ERROR_INJECTABLE_OPTIONS_CONFLICT="@injectable can take only one parameter either {names}",e.ERROR_BUILD_MESSAGE='function "message". Parameters in a string do not match those in array: ',e.ERROR_INIT_PLUGIN="not installed. Make sure to call `Vue.use(VueInjector)` before creating root instance.",e.ERROR_PROVIDERS_TYPE="providers are not objects",e.ERROR_USE_DECORATOR="no decorator Injectable",e.ERROR_USE_FACTORY_RETURN="useFactory invalid return",e.ERROR_USE_VALUE_RETURN="invalid useValue",e.ERROR_USE_FACTORY_TYPE="{name} invalid type useFactory: must be 'function'",e.ERROR_EMTY_INJECT_PARAMS="@inject must get a service as parameter"}(r||(r={})),function(e){e.WARNING_000="Wrong service registration. Service name: {name}.\n@injectable can take only one parameter either useFactory or useValue, but got {options}"}(o||(o={}));var u,a={TYPE:Symbol("inject:type"),VALUE:Symbol("inject:value"),NAME:Symbol("inject:name"),SERVICE:Symbol("inject:service"),TS_TYPE:"design:type"};!function(e){e.useFactory="useFactory",e.useValue="useValue"}(u||(u={}));var s=function(){function e(){}return Object.defineProperty(e,"whitelist",{get:function(){return Reflect.ownKeys(u)},enumerable:!1,configurable:!0}),e.getOptionKeys=function(e){return Reflect.ownKeys(e)},e.isOtherProperty=function(t){return!e.getOptionKeys(t).every((function(t){return-1!==e.whitelist.indexOf(String(t))}))},e.isCollisionProps=function(t){return e.whitelist.filter((function(e){return Reflect.has(t,e)})).length>1},e.getType=function(t){return e.whitelist.find((function(e){return Reflect.has(t,e)}))},e.getServiceType=function(t,n){if(e.isOtherProperty(n)&&e.warnMassage(t,n),e.isCollisionProps(n))throw e.errorMassage();return e.getType(n)?u[e.getType(n)]:null},e.errorMassage=function(){throw c(!1,i(r.ERROR_INJECTABLE_OPTIONS_CONFLICT,{names:JSON.stringify(e.whitelist)}))},e.warnMassage=function(e,t){i(o.WARNING_000,{name:e.name,options:JSON.stringify(t)})},e.make=function(e,t){return void 0===t&&(t={}),this.defineMetadata(e,t),this.createDecorators(e),e},e.defineMetadata=function(t,n){var r=e.getServiceType(t,n);r&&(Reflect.defineMetadata(a.TYPE,r,t),Reflect.defineMetadata(a.VALUE,n[r],t)),Reflect.defineMetadata(a.NAME,t.name,t),Reflect.defineMetadata(a.SERVICE,!0,t)},e.createDecorators=function(e){e.__decorators__&&(e.__decorators__.forEach((function(t){return t(e.prototype)})),delete e.__decorators__)},e}();function f(e){return"function"==typeof e?s.make(e):function(t){return s.make(t,e)}}function p(e){return t=function(t,n){(t.providers||(t.providers={}))[n]=e},function(e,n){var r="function"==typeof e?e:e.constructor,o={enumerable:!0,configurable:!0,initializer:function(){return this.__proto__[n]}};return function(e,t,n){var r=e.$setupInjector;e.$setupInjector=function(e){r&&r(e),n(e,t)}}(e,n,t),(r.__decorators__||(r.__decorators__=[])).push((function(e){return t(e,n)})),o};var t}function l(e,t){if("function"==typeof e||void 0===t)return p(e);var n=Reflect.getMetadata(a.TS_TYPE,e,t);if(void 0===n)throw c(!1,r.ERROR_EMTY_INJECT_PARAMS);p(n)(e,t)}var d=function(){function e(){}return e.bind=function(e,t,n){return Reflect.defineProperty(e,n,{enumerable:!0,configurable:!1,get:function(){return t}})},e}(),v=function(){function e(){}return e.prototype.getFactory=function(e){var t=Reflect.getMetadata(a.NAME,e),n=Reflect.getMetadata(a.VALUE,e);if(n&&"function"!=typeof n)throw c(!1,i(r.ERROR_USE_FACTORY_TYPE,{name:t}));var o=n();if(!o)throw c(!1,r.ERROR_USE_FACTORY_RETURN);return function(){return o}},e}(),y=function(){function e(){}return e.prototype.getFactory=function(e){var t=Reflect.getMetadata(a.VALUE,e);if(t)return function(){return t};throw c(!1,r.ERROR_USE_VALUE_RETURN)},e}(),R=function(){function e(){}return e.prototype.getFactory=function(e){var t=new e;return function(){return t}},e}(),h=function(){function e(){}return e.make=function(t){var n=Reflect.getMetadata(a.TYPE,t);return e.getFactoryByName(n).getFactory(t)},e.getFactoryByName=function(e){switch(e){case u.useFactory:return new v;case u.useValue:return new y;default:return new R}},e}(),_=function(){function e(e){this.service=e,this.factory=null,this.register()}return Object.defineProperty(e.prototype,"instance",{get:function(){return this.factory()},enumerable:!1,configurable:!0}),e.prototype.bindTo=function(e,t){return d.bind(e,this.instance,t||this.name)},Object.defineProperty(e.prototype,"name",{get:function(){return Reflect.getMetadata(a.NAME,this.service)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isService",{get:function(){return!!Reflect.getMetadata(a.SERVICE,this.service)},enumerable:!1,configurable:!0}),e.prototype.isApp=function(t){return t===e.app},e.prototype.register=function(){if(this.isApp(this.service)?this.factory=function(){return e.app}:!this.factory&&this.isService&&(this.factory=h.make(this.service)),this.factory)return this.factory;throw c(!1,r.ERROR_USE_DECORATOR)},e}(),E=function(){function e(e,t){this.rootServices=[],_.app=e,this.app=e,this.rootServices=t,this.services=new Map}return e.prototype.registerComponent=function(e){var t=this;this.provideAllServices(e),this.rootServices.length&&this.rootServices.forEach((function(n){t.provide(n,e)}))},e.prototype.get=function(e){return this.provide(e)},e.prototype.provide=function(e,t,n){var r;void 0===t&&(t=null),t&&Object.hasOwnProperty.call(t,"$setupInjector")&&delete t.$setupInjector,this.services.has(e)||((null===(r=null==e?void 0:e.prototype)||void 0===r?void 0:r.providers)&&this.registerDependencies(e.prototype),this.services.set(e,new _(e)));var o=this.services.get(e);return t&&o.bindTo(t,n),o.instance},e.prototype.provideAllServices=function(e){var t,n=this;if(Object.hasOwnProperty.call(e,"providers")){var o=e.providers;if(!o||(t=o,Array.isArray(t)||"object"!=typeof t||null===t))throw c(!1,r.ERROR_PROVIDERS_TYPE);Object.keys(o).forEach((function(t){o&&Object.hasOwnProperty.call(o,t)&&n.provide(o[t],e,t)}))}},e.prototype.registerDependencies=function(e){this.provideAllServices(e),delete e.providers},e}(),g=function(){function e(e){var t=e.app,n=e.root,r=e.store;this.rootServices=[],this.rootServices=n||[],r&&(r.$injector=this),this.init(t)}return Object.defineProperty(e,"app",{get:function(){return this},enumerable:!1,configurable:!0}),e.prototype.init=function(e){this.app||(this.app=e,this.injector=new E(this.app,this.rootServices))},e.prototype.initComponent=function(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.$options)||void 0===t?void 0:t.methods)||void 0===n?void 0:n.$setupInjector)&&(e.$options.methods.$setupInjector(e),delete e.$options.methods.$setupInjector),this.injector&&this.injector.registerComponent(e)},e.prototype.get=function(e){return this.injector&&this.injector.get(e)},e}();g.version="__VERSION__";var O=function(){return(O=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};t.default={install:function(e,t){e.config.globalProperties.$injector=new g(O(O({},t),{app:e})),e.mixin({beforeCreate:function(){var e;void 0!==this.$options.providers&&(this.providers=this.$options.providers),"function"==typeof(null===(e=null==this?void 0:this.$injector)||void 0===e?void 0:e.initComponent)&&this.$injector.initComponent(this)}})}}}])}));