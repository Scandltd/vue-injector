/*!
 * 
 *   @scandltd/vue-injector v3.3.0
 *   (c) 2020 Scandltd
 *   @license GPL-2.0
 * 
 */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(window,function(){return n={},o.m=r=[function(t,e,r){"use strict";var n;r.r(e);var i,o,c,a="undefined"!=typeof window;function s(r,n){void 0===n&&(n={});var o=r,t=Reflect.ownKeys(n).filter(function(t){return null===r.match(new RegExp("{"+String(t)+"}"))});return t.length&&console.warn(i.ERROR_002+t),Object.keys(n).forEach(function(t){var e=new RegExp("{"+t+"}");o=r.replace(e,n[t])}),o}function u(t,e){if(!t)throw new Error(i.ERROR_000+" "+e)}function f(t){return!Array.isArray(t)&&"object"==typeof t&&null!==t}(o=i=i||{}).ERROR_000="[@scandltd/vue-injector]:",o.ERROR_001="@injectable can take only one parameter either {names}",o.ERROR_002='function "message". Parameters in a string do not match those in array: ',o.ERROR_003="not installed. Make sure to call `Vue.use(VueInjector)` before creating root instance.",o.ERROR_004="providers are not objects",o.ERROR_005="no decorator Injectable",o.ERROR_006="useFactory invalid return",o.ERROR_007="invalid useValue",o.ERROR_008="{name} invalid type useFactory: must be 'function'",o.ERROR_009="{method} is not a function",o.ERROR_010="@inject must get a service as parameter",(c||(c={})).WARNING_000="Wrong service registration. Service name: {name}.\n@injectable can take only one parameter either useFactory or useValue, but got {options}";var p=(l.bind=function(t,e,r){return Reflect.defineProperty(t,r,{enumerable:!0,configurable:!1,get:function(){return e}})},l);function l(){}var h,y,d={TYPE:Symbol("inject:type"),VALUE:Symbol("inject:value"),NAME:Symbol("inject:name"),SERVICE:Symbol("inject:service"),TS_TYPE:"design:type"};(y=h=h||{}).useFactory="useFactory",y.useValue="useValue";var v=(R.prototype.getFactory=function(t){var e=Reflect.getMetadata(d.NAME,t),r=Reflect.getMetadata(d.VALUE,t);if(r&&"function"!=typeof r)throw u(!1,s(i.ERROR_008,{name:e}));return function(){var t=r();if(!t)throw u(!1,i.ERROR_006);return t}},R);function R(){}var g=(b.prototype.getFactory=function(t){var e=Reflect.getMetadata(d.VALUE,t);if(e)return function(){return e};throw u(!1,i.ERROR_007)},b);function b(){}var _=(j.prototype.getFactory=function(t){var e=new t;return function(){return e}},j);function j(){}var m=(O.make=function(t){var e=Reflect.getMetadata(d.TYPE,t);return O.getFactoryByName(e).getFactory(t)},O.getFactoryByName=function(t){switch(t){case h.useFactory:return new v;case h.useValue:return new g;default:return new _}},O);function O(){}var E=(w.prototype.instance=function(){return this.$factory()},w.prototype.bindTo=function(t,e){return t?p.bind(t,this.$factory(),e||this.name):this.factory},Object.defineProperty(w.prototype,"factory",{get:function(){return this.$factory},set:function(t){this.$factory=t},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"name",{get:function(){return Reflect.getMetadata(d.NAME,this.service)},enumerable:!0,configurable:!0}),Object.defineProperty(w.prototype,"isService",{get:function(){return Reflect.getMetadata(d.SERVICE,this.service)},enumerable:!0,configurable:!0}),w.prototype.register=function(){if("Vue"===this.service.name&&(this.factory=function(){return w.app}),!this.factory&&this.isService&&(this.factory=m.make(this.service)),this.factory)return this.factory;throw u(!1,i.ERROR_005)},w);function w(t){this.service=t,this.$factory=null,this.register()}var P=(S.prototype.registerComponent=function(e){var r=this;if(Object.hasOwnProperty.call(e,"_providers")){var n=e._providers;if(!n||!f(n))throw u(!1,i.ERROR_004);Object.keys(n).forEach(function(t){n&&Object.hasOwnProperty.call(n,t)&&r.provide(e._providers[t],e,t)})}this.rootServices.length&&this.rootServices.forEach(function(t){r.provide(t,e)})},S.prototype.get=function(t){return this.provide(t)},S.prototype.provide=function(t,e,r){if(void 0===e&&(e=null),!this.services.has(t)){t.prototype.providers&&this.registerDependencies(t.prototype);var n=new E(t);this.services.set(t,n)}var o=this.services.get(t);return o.bindTo(e,r),o.instance()},S.prototype.registerDependencies=function(e){var r=this;if(!f(e.providers))throw u(!1,i.ERROR_004);Object.keys(e.providers).forEach(function(t){r.provide(e.providers[t],e,t)}),delete e.providers},S);function S(t,e){this.rootServices=[],E.app=t,this.app=t,this.rootServices=e,this.services=new Map}var M=(Object.defineProperty(V,"whitelist",{get:function(){return Reflect.ownKeys(h)},enumerable:!0,configurable:!0}),Object.defineProperty(V.prototype,"decorators",{get:function(){return this.target.__decorators__},enumerable:!0,configurable:!0}),Object.defineProperty(V.prototype,"optionKeys",{get:function(){return Reflect.ownKeys(this.options)},enumerable:!0,configurable:!0}),Object.defineProperty(V.prototype,"isOtherProperty",{get:function(){return!this.optionKeys.every(function(t){return-1!==V.whitelist.indexOf(t)})},enumerable:!0,configurable:!0}),Object.defineProperty(V.prototype,"isCollisionProps",{get:function(){var e=this;return 1<V.whitelist.filter(function(t){return Reflect.has(e.options,t)}).length},enumerable:!0,configurable:!0}),Object.defineProperty(V.prototype,"type",{get:function(){var e=this;return V.whitelist.find(function(t){return Reflect.has(e.options,t)})},enumerable:!0,configurable:!0}),Object.defineProperty(V.prototype,"serviceType",{get:function(){if(this.isOtherProperty&&this.warnMassage(),this.isCollisionProps)throw V.errorMassage();return this.type?h[this.type]:null},enumerable:!0,configurable:!0}),V.errorMassage=function(){throw u(!1,s(i.ERROR_001,{names:JSON.stringify(V.whitelist)}))},V.prototype.make=function(t,e){return void 0===e&&(e={}),this.target=t,this.options=e,this.defineMetadata(),this.createDecorators(),this.target},V.prototype.warnMassage=function(){s(c.WARNING_000,{name:this.target.name,options:JSON.stringify(this.options)})},V.prototype.defineMetadata=function(){this.serviceType&&(Reflect.defineMetadata(d.TYPE,this.serviceType,this.target),Reflect.defineMetadata(d.VALUE,this.options[this.serviceType],this.target)),Reflect.defineMetadata(d.NAME,this.target.name,this.target),Reflect.defineMetadata(d.SERVICE,!0,this.target)},V.prototype.createDecorators=function(){var e=this;this.decorators&&(this.decorators.forEach(function(t){return t(e.target.prototype)}),delete this.target.__decorators__)},V);function V(){this.target=null,this.options={}}function T(e){var r=new M;return"function"==typeof e?r.make(e):function(t){return r.make(t,e)}}function x(r){return function(o){return function(t,e){var r="function"==typeof t?t:t.constructor,n={enumerable:!0,configurable:!0,initializer:function(){return this.__proto__[e]}};return Reflect.defineProperty(t,e,n),(r.__decorators__||(r.__decorators__=[])).push(function(t){return o(t,e)}),n}}(function(t,e){(t.providers||(t.providers={}))[e]=r})}function N(t,e){if("function"==typeof t)return x(t);var r=Reflect.getMetadata(d.TS_TYPE,t,e);if(void 0===r)throw u(!1,i.ERROR_010);x(r)(t,e)}r.d(e,"VueInjector",function(){return $}),r.d(e,"Injectable",function(){return T}),r.d(e,"Inject",function(){return N});var $=(Object.defineProperty(A,"app",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"install",{get:function(){return A.install},enumerable:!0,configurable:!0}),A.prototype.init=function(t){this.apps.push(t),this.app||(this.app=t,this.injector=new P(this.app,this.rootServices))},A.prototype.initComponent=function(t){return this.injector&&this.injector.registerComponent(t)},A.prototype.get=function(t){return this.injector&&this.injector.get(t)},A);function A(t){void 0===t&&(t={}),this.rootServices=[],this.app=null,this.injector=null,this.apps=[],this.rootServices=t.root||[],t.store&&(t.store.$injector=this)}$.install=function t(e){if(!t.installed||n!==e){t.installed=!0;var r=function(t){return void 0!==t};(n=e).mixin({beforeCreate:function(){r(this.$options.providers)&&(this._providers=this.$options.providers),r(this.$options.injector)?((this._injectorRoot=this)._injector=this.$options.injector,this._injector.init(this)):(this._injectorRoot=this.$parent&&this.$parent._injectorRoot||this,this._injectorRoot._injector&&this._injectorRoot._injector.initComponent(this))}}),Object.defineProperty(e.prototype,"$injector",{get:function(){return this._injectorRoot&&this._injectorRoot._injector}}),e.config.optionMergeStrategies._injectorRoot=function(t,e){return void 0===e?t:e}}},$.version="__VERSION__",a&&window.Vue&&window.Vue.use($)}],o.c=n,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=0);function o(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return r[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}var r,n});